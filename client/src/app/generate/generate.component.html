<div class="container">
  
  <div *ngIf="getDataRequestPending" class="spinner-wrapper row justify-content-center mt-5">
    <div class="spinner-border text-primary" style="width: 5rem; height: 5rem;" role="status">
      <span class="sr-only">Pobieranie...</span>
    </div>
  </div>

  <div class="col justify-content-start p-3" *ngIf="!getDataRequestPending">
    
    <div class="col">
      <table class="table table-striped">
        <thead>
          <tr>
            <th scope="col">kategorie:</th>
            <th  class="table-number" scope="col">ilość pytań:</th>
            <th  class="table-number" scope="col">pojedyncze:</th>
            <th  class="table-number" scope="col">multi:</th>
            <th  class="table-number" scope="col">otwarte:</th>
          </tr>
          <tr>
            <th  class="test-info filter-container">
              <input type="text" placeholder="wyszukaj ..." (keyup)="search()" [(ngModel)]="filter">
              <button *ngIf="filter" class="clear-button smaller" (click)="search(true)">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">
                      <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                      <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                  </svg>
              </button>
            </th>
          </tr>
        </thead>
        <tbody *ngIf="filteredCategories.length">
          <ng-container *ngFor="let category of filteredCategories">
            <tr [ngClass]="{'active': activeCategory == category.name}" (click)="setActiveCategory(category.name)">
              <td scope="row">{{ category.name }}</td>
              <td class="table-number" >{{ category.amount }}</td>
              <td class="table-number" >{{ category.singleAmount }}</td>
              <td class="table-number" >{{ category.multiAmount }}</td>
              <td class="table-number" >{{ category.openAmount }}</td>
            </tr>
          </ng-container>
        </tbody>
        <div *ngIf="!filteredCategories.length" class="no-data">brak wyników do wyświetlenia</div>
      </table>
    </div>
  </div>

    <div class="row justify-content-center">
        <h5 *ngIf="activeCategory" >Kategoria: {{ activeCategory }}</h5>
    </div>
    <div *ngIf="activeCategory && !downloading" class="row justify-content-center">
        <button class="btn btn-primary" (click)="getRandom()">generuj</button>
        <button *ngIf="randomQuestions.singleSelect && randomQuestions.singleSelect.length 
        && randomQuestions.multiSelect && randomQuestions.multiSelect.length
        && randomQuestions.open && randomQuestions.open.length" class="btn btn-primary print-button" (click)="downloadPdf()">pobierz test</button>
        <button *ngIf="randomQuestions.singleSelect && randomQuestions.singleSelect.length 
        && randomQuestions.multiSelect && randomQuestions.multiSelect.length
        && randomQuestions.open && randomQuestions.open.length" class="btn btn-primary print-button" (click)="downloadResolvedPdf()">pobierz rozwiązanie</button>
        <button *ngIf="randomQuestions.singleSelect && randomQuestions.singleSelect.length 
        && randomQuestions.multiSelect && randomQuestions.multiSelect.length
        && randomQuestions.open && randomQuestions.open.length" class="btn btn-primary print-button" (click)="saveTest()">zapisz test</button>
    </div>
    <div class="spinner-wrapper row justify-content-center mt-5">
      <div *ngIf="downloading" class="spinner-border text-primary" style="width: 5rem; height: 5rem;" role="status">
        <span class="sr-only">Pobieranie...</span>
      </div>
    </div>
    <app-test-card *ngIf="randomQuestions.singleSelect && randomQuestions.singleSelect.length 
    && randomQuestions.multiSelect && randomQuestions.multiSelect.length
    && randomQuestions.open && randomQuestions.open.length && !downloading" [questions]="randomQuestions" [category]="activeCategory">
  </app-test-card>
  <h4 class="row justify-content-center" *ngIf="notEnoughQuestions">za mało pytań w wybranej kategorii</h4>

</div>